title: Effective Java 笔记
date: 2016-07-28 17:18:34
tags:
---
记录一下 Effective Java 的读书笔记，以及当时的思考。
<!--more  -->
## 组合和继承
### 继承的缺点
1.  **自用性引起的**  
方法 A 和 方法 B ， 其中方法 B 的依赖于方法 A ，这代表方法 A 是有自用性的，如果  
这2个方法都是可以覆盖的，子类覆盖了方法 A ，没有覆盖方法 B ，那么子类的方法 B ，可能不会  
获得如期的结果。  

    一个可能缓解的方式是，重写方法的时候，也调用父类的方法实现，即 super.methodName(params) .    
    再或者就是，把自用性的方法，再全部 copy 一边变成私有方法。
2. **父类拓展新方法**  
如果子类继承旧版的父类，并且加了一个方法 A ，如果新版的父类拓展了一个方法 A1 ，A 和 A1   
方法签名一样，但是返回值不一样，那么编译不过了。子类如果是业务类，那么 N 多地方需要改，  
这就坑爹了。


  这个应该是没办法处理的了，子类加新方法的时候，得注意下名称，尽量业务化。
## 继承的注意事项
构造器，不能调用可以被覆盖的方法。例如，方法 A 在构造器中被调用了，子类重写了方法 A ，  
那么在实例化子类的时候，是先调用父类的构造器的，那么这时候是会先调用子类的方法 A ，如果  
这个方法调用了子类的成员变量，那么这个成员变量，很可能还没有来得及初始化，就被调用了，  
这个时候很容易出现 NullPointException 。

### 组合的出现和实现
就是因为以上，继承存在的缺点，如果不是特意设计成被继承的类，可以采用组合的方式。  
如现有类 A ，有方法 A1 和 A2 。需要加一点功能的话，可以再设计一个类 B ，这个类持有  
类 A 作为成员变量，在需要的地方把实现交给类 A 的方法 A1 和 A2 。


## 类层次优于标签类
有时候一个类，可能有多种风格，其中会有一个 type 变量，指定不同的风格，然后不同的风格，  
会有一些相同的变量，但是更多的是有不同的变量。这样看起来，会很乱。


其实可以这样，把相同的属性或者方法，抽象成一个基类 A（是否抽象，看需求），然后子类可以  
把自己的变量定义在子类中。


举个例子，在实际中，如果 View 的入口很多，而且不同的入口，传一个自定义参数（A1 or A2 or A3）  
进来后会有大量的逻辑差异，这个时候就可以用上述办法了，通过运行时判断类型，进而作出不同的变化。  
**缺点** 如果有新来的开发者，调用至二个入口，可能会存在不知道传递什么类, Ax ？  这  
就需要在入口方法写好文档了。  


进入到 View 之后，根据不同的类型做不同的逻辑，如果以后的交互当中，还需要判断不同的逻辑，  
建议可以把，每个逻辑差异标记到成员变量当中，而不是每次都动态判断该类的类型，从而做出不同逻辑。  
这是因为，该类的类型，可能存在很多种。
